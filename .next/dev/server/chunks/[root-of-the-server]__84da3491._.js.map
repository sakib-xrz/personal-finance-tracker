{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sakib/Downloads/personal-finance-tracker/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\r\n\r\nconst globalForPrisma = globalThis as unknown as {\r\n  prisma: PrismaClient | undefined;\r\n};\r\n\r\nfunction createPrismaClient(): PrismaClient {\r\n  if (globalForPrisma.prisma) {\r\n    return globalForPrisma.prisma;\r\n  }\r\n\r\n  // Initialize Prisma Client\r\n  const client = new PrismaClient();\r\n\r\n  if (process.env.NODE_ENV !== \"production\") {\r\n    globalForPrisma.prisma = client;\r\n  }\r\n\r\n  return client;\r\n}\r\n\r\nexport function getPrisma(): PrismaClient {\r\n  return createPrismaClient();\r\n}\r\n\r\nexport default getPrisma;\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM,kBAAkB;AAIxB,SAAS;IACP,IAAI,gBAAgB,MAAM,EAAE;QAC1B,OAAO,gBAAgB,MAAM;IAC/B;IAEA,2BAA2B;IAC3B,MAAM,SAAS,IAAI,6IAAY;IAE/B,wCAA2C;QACzC,gBAAgB,MAAM,GAAG;IAC3B;IAEA,OAAO;AACT;AAEO,SAAS;IACd,OAAO;AACT;uCAEe"}},
    {"offset": {"line": 80, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sakib/Downloads/personal-finance-tracker/app/api/transactions/stats/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\r\nimport { getPrisma } from \"@/lib/prisma\";\r\n\r\n// GET: Fetch transaction statistics\r\nexport async function GET(request: NextRequest) {\r\n  try {\r\n    const searchParams = request.nextUrl.searchParams;\r\n    const month = searchParams.get(\"month\");\r\n\r\n    const where: any = {};\r\n\r\n    if (month) {\r\n      where.month = month;\r\n    }\r\n\r\n    const prisma = getPrisma();\r\n    const transactions = await prisma.transaction.findMany({\r\n      where,\r\n    });\r\n\r\n    // Calculate totals\r\n    let income = 0;\r\n    let expense = 0;\r\n    let savings = 0;\r\n\r\n    transactions.forEach((transaction) => {\r\n      const amount = Number(transaction.amount);\r\n      switch (transaction.type) {\r\n        case \"INCOME\":\r\n          income += amount;\r\n          break;\r\n        case \"EXPENSE\":\r\n          expense += amount;\r\n          break;\r\n        case \"SAVINGS\":\r\n          savings += amount;\r\n          break;\r\n      }\r\n    });\r\n\r\n    // Calculate additional statistics\r\n    const totalTransactions = transactions.length;\r\n    const incomeTransactions = transactions.filter(\r\n      (t) => t.type === \"INCOME\"\r\n    ).length;\r\n    const expenseTransactions = transactions.filter(\r\n      (t) => t.type === \"EXPENSE\"\r\n    ).length;\r\n    const savingsTransactions = transactions.filter(\r\n      (t) => t.type === \"SAVINGS\"\r\n    ).length;\r\n\r\n    // Calculate balance (income - expense - savings)\r\n    const balance = income - expense - savings;\r\n\r\n    // Get description breakdown\r\n    const descriptionBreakdown: Record<\r\n      string,\r\n      { income: number; expense: number; savings: number }\r\n    > = {};\r\n\r\n    transactions.forEach((transaction) => {\r\n      const description = transaction.description;\r\n      const amount = Number(transaction.amount);\r\n\r\n      if (!descriptionBreakdown[description]) {\r\n        descriptionBreakdown[description] = { income: 0, expense: 0, savings: 0 };\r\n      }\r\n\r\n      switch (transaction.type) {\r\n        case \"INCOME\":\r\n          descriptionBreakdown[description].income += amount;\r\n          break;\r\n        case \"EXPENSE\":\r\n          descriptionBreakdown[description].expense += amount;\r\n          break;\r\n        case \"SAVINGS\":\r\n          descriptionBreakdown[description].savings += amount;\r\n          break;\r\n      }\r\n    });\r\n\r\n    return NextResponse.json({\r\n      success: true,\r\n      data: {\r\n        totals: {\r\n          income,\r\n          expense,\r\n          savings,\r\n          balance,\r\n        },\r\n        counts: {\r\n          total: totalTransactions,\r\n          income: incomeTransactions,\r\n          expense: expenseTransactions,\r\n          savings: savingsTransactions,\r\n        },\r\n        descriptionBreakdown,\r\n      },\r\n    });\r\n  } catch (error) {\r\n    console.error(\"Error fetching statistics:\", error);\r\n    return NextResponse.json(\r\n      {\r\n        success: false,\r\n        error: \"পরিসংখ্যান আনতে ব্যর্থ হয়েছে\",\r\n        message: error instanceof Error ? error.message : \"অজানা ত্রুটি\",\r\n      },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAGO,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,eAAe,QAAQ,OAAO,CAAC,YAAY;QACjD,MAAM,QAAQ,aAAa,GAAG,CAAC;QAE/B,MAAM,QAAa,CAAC;QAEpB,IAAI,OAAO;YACT,MAAM,KAAK,GAAG;QAChB;QAEA,MAAM,SAAS,IAAA,4HAAS;QACxB,MAAM,eAAe,MAAM,OAAO,WAAW,CAAC,QAAQ,CAAC;YACrD;QACF;QAEA,mBAAmB;QACnB,IAAI,SAAS;QACb,IAAI,UAAU;QACd,IAAI,UAAU;QAEd,aAAa,OAAO,CAAC,CAAC;YACpB,MAAM,SAAS,OAAO,YAAY,MAAM;YACxC,OAAQ,YAAY,IAAI;gBACtB,KAAK;oBACH,UAAU;oBACV;gBACF,KAAK;oBACH,WAAW;oBACX;gBACF,KAAK;oBACH,WAAW;oBACX;YACJ;QACF;QAEA,kCAAkC;QAClC,MAAM,oBAAoB,aAAa,MAAM;QAC7C,MAAM,qBAAqB,aAAa,MAAM,CAC5C,CAAC,IAAM,EAAE,IAAI,KAAK,UAClB,MAAM;QACR,MAAM,sBAAsB,aAAa,MAAM,CAC7C,CAAC,IAAM,EAAE,IAAI,KAAK,WAClB,MAAM;QACR,MAAM,sBAAsB,aAAa,MAAM,CAC7C,CAAC,IAAM,EAAE,IAAI,KAAK,WAClB,MAAM;QAER,iDAAiD;QACjD,MAAM,UAAU,SAAS,UAAU;QAEnC,4BAA4B;QAC5B,MAAM,uBAGF,CAAC;QAEL,aAAa,OAAO,CAAC,CAAC;YACpB,MAAM,cAAc,YAAY,WAAW;YAC3C,MAAM,SAAS,OAAO,YAAY,MAAM;YAExC,IAAI,CAAC,oBAAoB,CAAC,YAAY,EAAE;gBACtC,oBAAoB,CAAC,YAAY,GAAG;oBAAE,QAAQ;oBAAG,SAAS;oBAAG,SAAS;gBAAE;YAC1E;YAEA,OAAQ,YAAY,IAAI;gBACtB,KAAK;oBACH,oBAAoB,CAAC,YAAY,CAAC,MAAM,IAAI;oBAC5C;gBACF,KAAK;oBACH,oBAAoB,CAAC,YAAY,CAAC,OAAO,IAAI;oBAC7C;gBACF,KAAK;oBACH,oBAAoB,CAAC,YAAY,CAAC,OAAO,IAAI;oBAC7C;YACJ;QACF;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,MAAM;gBACJ,QAAQ;oBACN;oBACA;oBACA;oBACA;gBACF;gBACA,QAAQ;oBACN,OAAO;oBACP,QAAQ;oBACR,SAAS;oBACT,SAAS;gBACX;gBACA;YACF;QACF;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,OAAO,gJAAY,CAAC,IAAI,CACtB;YACE,SAAS;YACT,OAAO;YACP,SAAS,iBAAiB,QAAQ,MAAM,OAAO,GAAG;QACpD,GACA;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}